<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/style.css">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="mainText">
        <h1>От ER-диаграмм к реляционным схемам</h1>
      

        <div class="part">
            Процесс превращения ER-диаграммы в реляционную схему довольно прямолинеен.
            <ul>
                <li>Преобразовать каждое множество сущностей в отношение с тем же набором атрибутов</li>
                <li>Заменить каждую связь отношением, атрибуты котрого являются ключами множеств сущностей, соединяемых этой связью</li>
            </ul>
            Хотя названные правила охватывают бОльшую часть предмета, существует некоторые ситуации, которые стоит принять во внимание:
            <ol>
                <li>Слабые множества сущностей не могут быть преобразованы в отношения непосредственно</li>
                <li>Связи isa и подклассы требуют специального подхода</li>
                <li>Иногда целесообразхно объединить в составе одного отношения два других.</li>
            </ol>
        </div>

        <div class="part">
            <h2>От множеств сущностей к отношениям</h2>

            Чтобы создать отношение на основе некоторого множества сущностей, достаточно создать отношение с тем же именем и набором атрибутов,
            присущие этому множеству сущностей.

            <div class="example">
                Полученные схемы отношений на основе нижеприведённой диаграммы будут следующими:

                <ol>
                    <li>
                        Футбольный клуб {<u>Название</u>, Стадион, Цвет}
                    </li>
                    <li>
                        Футболист {<u>Номер</u>, <u>Имя</u>, Позиция}
                    </li>
                </ol>
                <div class="exampleImage">
                   <img src="/images/db/SQL/PosgreSQL/4chapter/erToRelation.png" alt="">
                </div>
            </div>
        </div>


        <div class="part">
            <h2>От ER-связей к отношениям</h2>

            ОТношение для заданной связи R охватывает следующие атрибуты:

            <ol>
                <li>В схему отношений для связи R заносятся ключевые атрибуты каждого из множеств сущностей, соединямых связью R</li>
                <li>Если связь обладает собственными атрибутами, они также вводятся в набор атрибутов отношения для этой связи</li>
            </ol>
                
            <div class="example">
                На основе вышеприведённой диаграммы, отношения для связи "ФутболистВФК" будет следующей:
                <ul>
                    <li>
                        ФутболистВФК{ <u>Название</u>,  <u>Номер</u>, <u>Имя</u> }
                    </li>
                </ul>
            </div>

            Если одно и то же множестве сущностей в контексте связи упоминается многократно, в различных "ролях", каждый из его 
            ключевых атрибутов вводится в отношение столько раз, в скольких ролях он учасвтвует. Во избежание конфликтов, имена атрибутов 
            должны быть изменены.

        </div>

        <div class="part">
            <h2>Объеденение отношений</h2>

            Иногда отношения, полученные в результате прямых преобразований из множеств сущностей или связей, инельзя считать наилучшей формой
            представления определённых элементов данных. Один из вариантов подобных ситуаций следующий:
            имеется множество сущностей Е, соединённое посредством связи R типа "многие к одному" с множеством F в направление от E к F.
            Реляционные схема каждого из отношений, полученных на основе множества Е и связи R, будут содержать ключ множества Е. Кроме того,
            в схему отношения для множества Е будут введены также атрибуты Е, не относящиеся к ключевым, а в схему отношения для связи R --
            собственные атрибуты R и ключевые атрибуты F. Поскольку связь R относится к типу "многие к одному", все указанные атрибуты
            обладают значениями, которые однозначным образом определяются на основе ключа множества Е, и их можно объединить в одной схеме
            отношения, состоящей из:
            <ol>
                <li>Всех атрибутов Е</li>
                <li>Ключевых атрибутов F</li>
                <li>Собственных атрибутов R</li>
            </ol>

            В случае, если для сущности е множества Е, которая не связана ни с одной сущностью множества F, компоненты, отвечающие атрибутам, 
            получат "нулвые" (null) значения.
            <div class="example">
                Рассмотрим следующую диаграмму. Поскольку связь "ФутболиствФК" -- связь типа <b>многие к одному</b> от "Футболист" к "ФутбольныйКлуб",
                мы вправе объединить в одно отношения множества сущностей "Футболист" и "Футбольный клуб".
                <div class="exampleImage"> 
                   <img src="/images/db/SQL/PosgreSQL/4chapter/entitiesUnion.png" alt="">
                </div>
            </div>

            Стоит ли объединять отношения таким образом или нет -- вопрос ситуации. С одной стороны, гораздо проще получить ответ на запрос,
            касающийся данных, которые размещены в одном отношении, нежели обращаться за теми же данными одновременны к нескольким отношениям.
            С другом стороны, не следует серьёзно рассматривать возможность объединения отношения для множества Е с отношения связи R, которая 
            охватывает Е, но не является связью типа "многие к одному", направленной от Е к каким-либо другим множествам, поскольку подобная
            опервция может привести к избыточности данных.

            Не стоит рассматривать данный приём для связей типа <b>многие ко многим</b>, поскольку данный метод приведёт к избыточности данных.
        </div>

        <div class="part">
            <h2>Преобразование слабых множеств сущностей</h2>
            
            Для преобразования слабого множества сущностей в отношение необходимо принять во внимание следующе:
            <ol>
                <li>
                    Отношения для слабого множества сущностей W как такового должно включать не только собственные атрибуты W, но и 
                    ключевые атрибуты всех других множеств, содействующих в формировании ключа множества W. Подобные вспомогательные 
                    множества сущностей соединяются с W посредством поддерживающих связей, которые обозначаются двойными ромбами.
                </li>
                <li>
                    В отношении для любой связи, с которой соединено слабое множество сущностей W, должны быть отражены
                    все ключевые атрибуты множества W, в том числе и те, которые "получены" им от других множеств.
                </li>
                <li>
                    Поддерживающая связь R, соединяющая слабое множество сущностей W с другим множеством, помогающим в образовании ключа W
                    вовсе не нуждается в преобразовании.
                </li>
            </ol>
            
            <div class="example">
                Исходя из данной ER-диаграммы, мы получим
                <ol>
                    <li>
                        Схему отношения для "Состав" {Клуб, Тренер}
                    </li>
                    <li>
                        Схему отношения для "Футболист" {Номер, Имя, Позиция}
                    </li>
                    <li>
                        Потребность в преобразовании поддерживающей связи пропадает.
                    </li>
                </ol>
                <div class="exampleImage">
                    <img src="/images/db/SQL/PosgreSQL/4chapter/weakToRealtion.png" alt="">
                </div>
            </div>
        </div>

        <div class="part">
            <h2>Преобразование структур подклассов в отношения</h2>

            Имея дело с иерархией множств сущностей, соединённых связями isa, мы вправе выбрать одну из нескольких возможных стратегий
            преобразования ER-диаграмм в реляционные схемы. Имеем ряд положений:

            <ol>
                <li>Существует <i>корневое</i> множество сущностей иерархии.</li>
                <li>
                    Корневое множество сущностей обладает ключом, который используется для идентификации любой сущности из множеств,
                    входящих в иерархию.
                </li>
                <li>
                    Сущность может содержать компоненты, принадлежащие множествам сущностей любого поддерева иерархии, если только это поддерево
                    включает корневое множество.
                </li>
            </ol>

            Основные стратегии преобразования таковы:

            <ol>
                <li>
                    <i>Применить подход "сущность-связь"</i>. Для каждого множества сущностей Е иерархии создать отношение, содержащее
                ключевые атрибуты корневого множества сущностей и все атрибуты, принадлижащие Е.
                </li>
                <li>
                    <i>Трактовать сущности как объекты одного класса</i>. Для каждого возможного поддерева, включающего корневое множество
                    сущностей, создать одно отношение, схема которого содержит все атрибуты всех множеств сущностей, принадлижащих поддереву.
                </li>
                <li>
                    <i>Использовать значения null</i>. Создать одно отношение, включающее все атрибуты всех множеств сущностей, входящий в иерархию.
                    Каждая сущность представляется одним кортежем, и компоненты кортежа, соотвутствующие тем атрибутам, которых сущность не имеет, 
                    принимают значение null.
                </li>
            </ol>
            Рассмотрим каждую из стратегий на основе нижеприведённых диаграмм.
             
            <div class="example">
                Здесь будет пример
                <div class="exampleImage">
                   <img src="/images/db/SQL/PosgreSQL/4chapter/isaToRelation.png" alt="">
                </div>
            </div>

                <div>

                    <h3>Преобразование в стиле "сущность-связь"</h3>

                    Подход заключается в создании отношений для каждого множества сущностей. Если множество сущностей Е не является корневым, отношение для Е
                    должно содержать ключевые атрибуты корневого множества и все собственные атрибуты Е. Если, помимо того, множество Е соединено связью с другими
                    множествами, ключевые атрибуты используются для идентификации сущностей из Е в отношении, представляющие эту связь.
                    Называя связь isa связью, мы подразумеваем её принципиальное отличие от других связей, поскольку связь isa соединяет компоненты единой сущности,
                    а не различные сущности. Поэтому отношения для isa не создаются.
                   
                    На основе этой стратегии получим:

                    <ol>
                        <li>
                            Автомобиль {Мощность двигателя, Цвет, Год Выпуска}
                        </li>
                        <li>
                            Грузовой {Мощность двигателя, Цвет, Год Выпуска, Прицеп}
                        </li>
                        <li>
                            СпортКар {Мощность двигателя, Цвет, Год Выпуска, Спойлер}
                        </li>
                        <li>
                            СпецАвто {Мощность двигателя, Цвет, Год Выпуска, Мигалка}
                        </li>
                    </ol>
                </div>

                <div>     

                    <h3>Объектно-ориентированный подход</h3>

                   Другая стратегия предполагает перечисление всех возможных поддеревьев ER-диаграммы, включающих корневое множество сущностей, с последующим созданием
                   отношений, представляющих сущности, которые обладают всеми компонентами каждого поддерева. Схема отношений должна включать все атрибуты любого множества
                   сущностей, принадлежащего поддереву. Подход называется "Объектно-ориентированным", так как трактуем сущность как "объекты" одного и только одного "класса".
                    
                   На основе этой стратегии получим:

                   <ol>
                       <li>
                           Автомобиль {Мощность двигателя, Цвет, Год Выпуска}
                       </li>
                       <li>
                           АвтомобильГрузовой {Мощность двигателя, Цвет, Год Выпуска, Прицеп}
                       </li>
                       <li>
                           АвтомобильСпорт {Мощность двигателя, Цвет, Год Выпуска, Спойлер}
                       </li>
                       <li>
                           АвтомобильСпец {Мощность двигателя, Цвет, Год Выпуска, Мигалка}
                       </li>
                       <li>
                            АвтомобильГрузовойСпорт {Мощность двигателя, Цвет, Год Выпуска, Прицеп, Спойлер}
                        </li>
                        <li>
                            АвтомобильСпецГрузовой {Мощность двигателя, Цвет, Год Выпуска, Прицеп, Мигалка}
                        </li>
                        <li>
                            АвтомобильСпортСпец {Мощность двигателя, Цвет, Год Выпуска, Спойлер, Мигалка}
                        </li>
                        <li>
                            АвтомобильГрузСпецСпорт {Мощность двигателя, Цвет, Год Выпуска, Мигалка, Спойлер, Прицеп}
                        </li>
                   </ol>
                </div>

                <div>     

                    <h3>Значения null и объединение отношений</h3>

                   Если допустить возможность использование "нулевых значений" (null), можно "уместить" все множества в единственном отношении, которое охватывает все
                   атрибуты всех множеств иерархии. Произвольная сущность любого множества в этом случае представляется одним кортежем, компонентами которого присваиваются
                   значения null, если соответствующий атрибут не определен для рассматриваемой сущности.
                   
                   На основе этой стратегии получим:

                   <ol>
                       <li>Автомобиль {Мощность двигателя, Цвет, Год Выпуска, Мигалка, Спойлер, Прицеп}</li>
                    </ol>
                </div>

         
        </div>

    </div>
</body>