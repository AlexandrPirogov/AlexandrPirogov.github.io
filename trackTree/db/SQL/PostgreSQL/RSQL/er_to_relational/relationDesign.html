<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/newstyle.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="mainText">
       
        <h1>Проектирование реляционных схем</h1>

        <div class="part">
            <h2>Вступление</h2>

            В этом разделе мы обсудим некоторые аспекты проектирования добротных реляционных схем баз данных,а именно:
            <ol>
                <li>
                    Подробно рассмотрим <i>аномалии</i>, возникающие при выборе неправильного подхода к проектированию.
                </li>
                <li>
                    Введём понятие <i>декомпозиции</i>, определяющее способ разбиения реляционной схемы (т.е. множество атрибутов) на две более "мелкие" схемы.
                </li>
                 <li>
                    Дадим определение <i>Нормальной формы Бойса-Кодда</i> -- условия, исключающее аномалии реляционной схемы.
                 </li>
                 <li>
                    Объединим все рассмотренные положения и поясним, как добиться выполнения условия BCNF посредством декомпозции реляционных схем.
                 </li>
            </ol>
        </div>

        <div class="part">
            <h2>Аномалии</h2>

            Проблемы, подобные избыточности, возникает при попытки "заталкивания" в единственное отношение слишком большого числа атрибутов, принято называть
            <i>аномалиями</i>:
            <ol>
                <li>
                    <i>Избыточность</i>. Одинаковые элементы информации повторяются многократно в нескольких кортежах.
                </li>
                <li>
                    <i>Аномалии изменения</i>. Один и тот же фрагмент данных изменяется в одном кортеже, но остается нетронутым в другом.
                </li>
                <li>
                    <i>Аномалии удаления</i>. Если множество значений становится пустым, это косвенным образом может привести к потере некоторой другой
                    информации.
                </li>
            </ol>      
        </div>

        <div class="part">
            <h2>Декомпозиция отношений</h2>

            Один из способов устранений аномалий состоит в <i>декомпозиции</i> отношений. Декомпозиция отношения R предлагает разбиение множества атрибутов R с целью
            построения схем двух новых отношений с последующим занесением в эти отношения определенных кортежей отношения R. 
            <p>
                Заданное отношение R со схемой {A1, A2, .., An} может быть подвергнуто декомпозиции в два отношения S и T, которым соответствуют схемы {B1, B2, ..., Bm}
                и {C1, C2, ..., Ck}, удовлетворяющие условиям:

                <ol>
                    <li>
                        {A1, A2, ..., An} = {B1, B2, ..., Bm} объединенный с {C1, C2, ..., Ck}.
                    </li>
                    <li>
                        Кортежи отношение S являются <i>проекциями</i> всех кортежей отношения R на множество атрибутов {B1, B2, ..., Bm}. Другими, словами,
                        в каждом кортеже t текущего экзмепляра R выбираются компоненты, соответствующие атрибутом B1,B2, ..., Bm. Эти компоненты образуют новый кортеж
                        отношения S. Однако отношения являются множествами, и при проецировании двуз различных кортежей R на схему S могут быть получены идентичные 
                        кортежи отношения S. В подобных случаях следует помещать в S только одну копию кортежа из набора одинаковых кортежей.
                    </li>
                    <li>
                        Аналогично, кортежи отношения Т являются проекциями всех кортежей текущего экземпляра отношения R на множество атрибутов {C1, C2, ..., Ck}
                    </li>
                </ol>
            </p>
            <div class="example">
                Рассмотрим отношение "ФутбольныйКлуб". В нашем случае, атрибуты "Название", "Страна", "Стадион", "Турнир", "Год", "Трофеи" и "Колиечество мест".
                Для первого отношения, назовём его "ФК1", можно выбрать все атрибуты, за исключением "Год".
                <br>Для второго отношения, назовём его "ФК2", выбираем атрибуты "Название", "Год", "Игрок".
                <br>Для третьего отношения, назовём его "ФК3", берём атрибуты "Название", "Год", "Турнир".
                <br><br>Не смотря на повторение значений атрибутов "Название" и "Год" в отношениях "ФК2", "ФК3", стоит отметить, что данные атрибуты -- ключ, 
                функционально обуславливают остальные атрибуты.
                <div class="exampleImage">
                    <img src="/images/db/SQL/PosgreSQL/4chapter/decomposition.png" alt="">
                </div>
                <br>
                С помощью декомпозиции отношения мы избавились от:
                <ol>
                    <li>Избыточности.</li>
                    <li>Аномалии изменения. Скажем, значение стадиона каждого футбольного клуба включено единожды.</li>
                    <li>Аномалии удаления. Если мы удалим какой-либо клуб, то не утратим информацию об игроках.</li>
                </ol>
            </div>
        </div>

        <div class="part">
            <h2>Нормальная форма Бойса-Кодда</h2>

            Цель декомпозии состоит в замене одного отношения несколькими другими, не содержащими аномалий. Существует условие, которое гарантирует отсутствие этих аномалий.
            Это условие называют  <i>нормальной формой Бойса-Кодда</i>.
            <ul>
                <li>
                    Отношение R удовлетворяет BCNF, если и только если выполняется следующее требование: всякий раз, когда для отношения R существует некоторая нетривиальная FD
                    A1, A2, ..., An --> B, соответствующее множество {A1, A2, ..., An} представляет суперключ для R. Другими словами, атрибуты левой части любой нетривиальной 
                    FD должны образовывать суперключ. Другими словами, левая часть каждой нетривиальной FD должна содержать ключ.
                </li>
            </ul>

            <p>
                Отношение R удовлетворяет BCNF, если и только если выполняется следующее условие: всякий раз, когда для отношения R существует некоторая нетривиальная FD 
                A1 A2 ... An --> B1 B2 ... Bm, соответствующее множество {A1, A2, ..., An} представляет суперключ для R. 
            </p>
            <div class="example">
                Рассмотрим ранееприведённый пример. Отношение "ФутбольныйКлуб" не удовлетворяет условию BCNF. Чтобы понять это, мы должны определить, какие множества атрибутов
                являются ключами. {Название, Год, Игрок} -- ключ для данного отношения т.к ни одно из множеств, не охватывающее все три атрибута не может быть суперключом.
                <p>
                    Рассмотрим FD  Название --> Стадион, Трофеи, Игрок. Данная FD не является суперключом, т.к. не обуславливает атрибут "Игрок".
                </p>
                <div class="exampleImage">
                    <img src="/images/db/SQL/PosgreSQL/4chapter/decomposition.png" alt="">
                </div>

                <p>
                    Однако, в отношении "ФК1" FD Название --> Стадион, Трофеи, Цвет, КоличествоМест, Трофеи удовлетворяет условию BCNF. <br>
                    Стоит также отметить отношения "ФК2" и "ФК3". Хоть и значение атрибутов "Назвние", "Год" повторяется, но, справедливости ради, стоит учесть,
                    что мы избавились от аномалии изменения и удаления, а также данные атрибуты формируют ключ.
                </p>
            </div>

            Мы вправе утверждать, что любое отношение, содержащее два атрибута удовлетворяет BCNF.
        </div>

        <div class="part">
            <h2>Декомпозиция в BCNF</h2>

            Мы можем разбить любую реляционную схему на коллекцию подмножеств её атрибутов, каждое из которых обладает указанными важными свйоствами:

            <ol>
                <li>
                    Подмножества являются схемами отношений, удовлетворяющих условию BCNF.
                </li>
                <li>
                    Данные исходного отношения достоверно представляются отношениями, полученными в результате декомпозции (Проще говоря,  из разбитых схем, можем
                    собрать исходную). 
                </li>
            </ol>

            <p>
                Стратегия декомпозиции состоит в поиске нетривиальной FD A1 A2 ... An --> B1 B2 ... Bm, попирающей условие BCNF; множество {A1, A2, ... An} 
                в этом случае не является суперключом. В качестве эвристического правила можно предложить добавлять в правую часть FD все те атрибуты, которые 
                функционально обусловлены атрибутами множества {A1, A2, ..., An}. 
            </p>
            <div class="example">
                На рисунке показано, как множество атрибутов разбивается на две перекрывающиеся реляционные схемы. Одна из них содержит все атрибуты, 
                охватываемые "нарушающей" FD, а другая -- атрибуты левой части этой FD в совокупности со всеми атрибутами, которые не входят в состав FD (т.е все
                атрибуты отношения, за исключением тех B1, B2, ..., Bm, которые не совпадают ни с одним из A1, A2, ..., An). 
                <div class="exampleImage">
                   Здесь будет рисунок примера
                </div>
            </div>
        </div>


        <div class="part">
            <h2>Реконструкция данных из отношений декомпозиции</h2>

            
            <div class="example">
            </p>
                Здесь будет пример
                <div class="exampleImage">
                   Здесь будет рисунок примера
                </div>
            </div>
        </div>


        <div class="part">
            <h2>Третья нормальная форма </h2>

            Иногда множно встретить отношение с соответствующими FD, которые не удовлетворяют условию BCNF, но декомпозиция отношения, тем не менее, считается 
            нецелесообразной. 
            <div class="example">
                Здесь будет пример
                <div class="exampleImage">
                   Здесь будет рисунок примера
                </div>
            </div>

            Пример выше состоит в незначительной смягчении условия BCNF, допускающем возможность практического использования реляционной схемы, которую нельзя
            подвергнуть декомпозиции в отношения, удовлетворяющие BCNF, не теряя возможности проверить справедливость каждой FD применительно к одному отношению.
            Это ослабленное условие называют третьей нормальной формой (third normal form -- 3NF).
            <ul>
                <li>
                    Отношение R удовлетворяет 3NF, если выполняется следующее требование: всякий раз, когда для отношения R существует некоторая нетривиальная FD 
                    A1 A2 ... An --> B, соответствующее множество {A1, A2, ..., An} представляет суперключ для R либо B является членом некоторого ключа.
                </li>
            </ul>

            <p>
                Атрибут, принадлежащий некоторому ключу, часто называют первычным (prime). Поэтому условие 3NF можно сформулировать так:
                <q>
                    Для каждой нетривиальной FD должно выполняться одно из условий -- либо атрибуты её левой части представляют суперключ, либо атрибуты правой части
                    являются первичными
                </q>
            </p>
        </div>

    </div>
</body>